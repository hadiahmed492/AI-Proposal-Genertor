<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AI Proposal Generator</title>
  <style>
    /* Styling omitted for brevity ‚Äì same as before */
    /* You can keep your full style block here (copied from your existing file) */
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ü§ñ AI Proposal Generator</h1>
      <p>Generate winning freelance proposals in seconds</p>
    </div>

    <div class="form-container">
      <div class="form-tips">
        <h3>üí° Tips for Best Results:</h3>
        <ul>
          <li>Be specific about your skills and experience</li>
          <li>Copy the complete job description for better matching</li>
          <li>Include relevant portfolio links</li>
          <li>Check your email for the generated proposals</li>
        </ul>
      </div>

      <form id="proposalForm">
        <div class="form-group">
          <label for="freelancer_name">Your Full Name <span class="required">*</span></label>
          <input type="text" id="freelancer_name" name="freelancer_name" required placeholder="e.g., John Smith">
        </div>

        <div class="form-group">
          <label for="freelancer_email">Your Email Address <span class="required">*</span></label>
          <input type="email" id="freelancer_email" name="freelancer_email" required placeholder="john@example.com">
        </div>

        <div class="form-group">
          <label for="freelancer_skills">Your Key Skills <span class="required">*</span></label>
          <input type="text" id="freelancer_skills" name="freelancer_skills" required placeholder="e.g., Excel, CRM, Data Entry">
        </div>

        <div class="form-group">
          <label for="freelancer_experience">Your Experience Summary</label>
          <textarea id="freelancer_experience" name="freelancer_experience" placeholder="Brief experience summary"></textarea>
        </div>

        <div class="form-group">
          <label for="portfolio_link">Portfolio/Website Link</label>
          <input type="url" id="portfolio_link" name="portfolio_link" placeholder="https://yourportfolio.com">
        </div>

        <div class="form-group">
          <label for="job_title">Job Title</label>
          <input type="text" id="job_title" name="job_title" placeholder="e.g., Virtual Assistant">
        </div>

        <div class="form-group">
          <label for="job_description">Complete Job Description <span class="required">*</span></label>
          <textarea id="job_description" name="job_description" required placeholder="Paste the full job post here"></textarea>
        </div>

        <button type="submit" class="submit-btn" id="submitBtn">üöÄ Generate AI Proposals</button>
      </form>

      <div class="loading" id="loading">
        <div class="spinner"></div>
        <p>Generating your personalized proposals...</p>
        <p><small>This may take 30‚Äì60 seconds</small></p>
      </div>

      <div class="result" id="result"></div>
    </div>
  </div>

  <script>
    const WEBHOOK_URL = 'https://eooo01w8atvd77s.m.pipedream.net';

    document.getElementById('proposalForm').addEventListener('submit', async function(e) {
      e.preventDefault();

      const submitBtn = document.getElementById('submitBtn');
      const loading = document.getElementById('loading');
      const result = document.getElementById('result');
      const form = this;

      submitBtn.disabled = true;
      submitBtn.textContent = 'Generating...';
      loading.classList.add('show');
      result.style.display = 'none';

      const formData = new FormData(form);
      const data = Object.fromEntries(formData);

      Object.keys(data).forEach(key => {
        if (data[key] === '') {
          delete data[key];
        }
      });

      try {
        const response = await fetch(WEBHOOK_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });

        const responseText = await response.text();
        let resultData;
        try {
          resultData = JSON.parse(responseText);
        } catch {
          throw new Error('Invalid response format from server');
        }

        if (response.ok && resultData.success) {
          result.className = 'result success';
          result.innerHTML = `
            <h3>‚úÖ Success!</h3>
            <p>Proposals generated successfully. Check your email: <strong>${data.freelancer_email}</strong></p>
          `;
          form.reset();
        } else {
          throw new Error(resultData.error || 'Unknown error occurred');
        }

      } catch (error) {
        result.className = 'result error';
        result.innerHTML = `
          <h3>‚ùå Error</h3>
          <p>Failed to generate proposals: ${error.message}</p>
        `;
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = 'üöÄ Generate AI Proposals';
        loading.classList.remove('show');
        result.style.display = 'block';
        result.scrollIntoView({ behavior: 'smooth' });
      }
    });
  </script>
</body>
</html>
